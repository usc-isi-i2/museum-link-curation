<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Link Verification - Profile</title>
    <link rel='icon' href='../static/images/favicon.ico' type='image/x-icon'/>
    <meta name="generator" content="Bootply" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../static/css/style.css">
    <link rel="shortcut icon" type="image/x-icon" href="../static/images/main.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
</head>
<body>
    <script>
        $(document).ready(function () {
           var sv_profile = '{{server}}'.concat("/v1/user");

            $.ajax({
                    method: 'GET',
                    url: sv_profile,
                    contentType: 'application/json',
                    success: function(data){
                        console.log(data.tags)
                        for(i = 0; i < data.tags.length; i++) {
                            console.log(data.tags[i])
                            $('#'+data.tags[i]).prop('checked', true);
                        }
                    }
            });
            
            $("#save").click(function(e){
                e.preventDefault()
                var tag_list = [];
                tag_list.push($('input[name="museums"]:checked').map(
                    function () {return this.value;}).get());
                var userObj = new Object();
                userObj.tags = tag_list[0];
                json_data = JSON.stringify(userObj);

                var sv = '{{server}}'.concat("/v1/user");
                    $.ajax({
                        method: 'PUT',
                        url: sv,
                        data: json_data,
                        contentType: 'application/json',
                        success: function(data){
                            console.log("Tag Successfully submitted");
                            window.location.href = "/curation";
                        }
                    });
            });
            
        });

    </script>
    <div id = "header"> {% include 'header.html' %}</div>

    <br/>
    <center>
    <label style = 'white-space: pre;'>Please select all the museums that you would like to curate data for - </label>
    </center> 
    <br/><br/><br/>
    <div class="container" style="margin-left:70vh;margin-bottom:25vh">
        {% for tag in museums.keys() %}
        <input id={{tag}} type="checkbox" name="museums" value={{tag}} />
            <label for={{tag}}> {{museums[tag]['name']}} ( {{tag}} ) </label><br/>
        {% endfor %}
        <br/>
        <form name ="profile_tag_select">
            <button id = "save" type="submit" class="btn btn-primary btn-lg" style="margin-left:10vh">Save Changes</button>
        </form>
    </div>
    <div id = "footer">{% include 'footer.html' %}</div>
</body>
</html>